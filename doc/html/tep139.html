<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.10: http://docutils.sourceforge.net/" />
<title>The Source Routing Protocol (SRP)</title>
<meta name="author" content="Chieh-Jan Mike Liang, Eric Decker, Doug Carlson, and Omprakash Gnawali" />
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:date: $Date: 2009-02-03 23:07:32 $
:version: $Revision: 1.12 $
:copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.
*/
body {
  font-family: Times;
  font-size: 16px;
}

.first {
  margin-top: 0 ! important }

.last {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dd {
  margin-bottom: 0.5em }

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.attention, div.caution, div.danger, div.error, div.hint,
div.important, div.note, div.tip, div.warning, div.admonition {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

div.hint p.admonition-title, div.important p.admonition-title,
div.note p.admonition-title, div.tip p.admonition-title,
div.admonition p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em }

div.footer, div.header {
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 0em 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1 {
  font-family: Arial, sans-serif;
  font-size: 20px;
}

h1.title {
 text-align: center;
 font-size: 32px;
}

h2 {
 font-size: 16px;
 font-family: Arial, sans-serif;
}

h2.subtitle {
  text-align: center }

h3 {
 font-size: 12px;
 font-family: Arial, sans-serif;
}

hr {
  width: 75% }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.line-block {
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee;
  border-color: #000000;
  border-width: thin;
  font-size: 14px
}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.option-argument {
  font-style: italic }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

table {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.citation {
  border-left: solid thin gray ;
  padding-left: 0.5ex }

table.docinfo {
  margin: 2em 4em;
}

table.footnote {
  border-left: solid thin black ;
  padding-left: 0.5ex }

td, th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

th.docinfo-name, th.field-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap;
  }

h1 tt, h2 tt, h3 tt, h4 tt, h5 tt, h6 tt {
  font-size: 100% }

tt {}

ul.auto-toc {
  list-style-type: none }


</style>
</head>
<body>
<div class="document" id="the-source-routing-protocol-srp">
<h1 class="title">The Source Routing Protocol (SRP)</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">TEP:</th><td class="field-body">139</td>
</tr>
<tr class="field"><th class="docinfo-name">Group:</th><td class="field-body">Network Working Group</td>
</tr>
<tr class="field"><th class="docinfo-name">Type:</th><td class="field-body">Documentary</td>
</tr>
<tr><th class="docinfo-name">Status:</th>
<td>Draft</td></tr>
<tr class="field"><th class="docinfo-name">TinyOS-Version:</th><td class="field-body">&gt; 2.1</td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>Chieh-Jan Mike Liang, Eric Decker, Doug Carlson, and Omprakash Gnawali</td></tr>
<tr class="field"><th class="docinfo-name">Draft-Created:</th><td class="field-body">18-Jun-2010</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Version:</th><td class="field-body">$Revision$</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Modified:</th><td class="field-body">$Date$</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Discuss:</th><td class="field-body">TinyOS Developer List &lt;tinyos-devel at mail.millennium.berkeley.edu&gt;</td>
</tr>
</tbody>
</table>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">This memo documents a part of TinyOS for the TinyOS Community, and
requests discussion and suggestions for improvements. Distribution
of this memo is unlimited. This memo is in full compliance with
TEP 1.</p>
</div>
<div class="section" id="abstract">
<h1>Abstract</h1>
<p>This memo documents the Source Routing Protocol (SRP), which provides
best-effort point-to-point datagram communication in a network.</p>
</div>
<div class="section" id="introduction">
<h1>1. Introduction</h1>
<p>A source routing protocol delivers packets from the origin node to the
destination node. Specifically, source routing allows the origin node to
specify the route the packet should take in the network. In this
respect, source routing is considered as one implementation of the
forwarding engine in network protocols.</p>
<p>The Source Routing Protocol (SRP) is a reference implementation of
source routing in TinyOS 2.x. SRP is a network-level protocol built on
top of the TinyOS Active Message (AM) Layer which provides unreliable
delivery over multi-link routes. Users interact with SRP through the
source routing interfaces described in TEP 138 <a class="footnote-reference" href="#id2" id="id1">[1]</a>.</p>
<p>In this TEP, after a brief discussion of source routing and SRP, we
specify the packet format used by SRP, and how fields in the packet are
used to deliver packets in the network. There are no control frames in
SRP; all information necessary for source routing is carried in the data
frame.</p>
<p>All fields in this specification are in network byte order.</p>
</div>
<div class="section" id="source-routing-and-srp">
<h1>2. Source routing and SRP</h1>
<p>Source routing relies on the origin node to specify the list of nodes
that a packet should traverse to reach the destination node. Mechanisms
for path determination are beyond the scope of this specification.</p>
<p>Source routing is useful in many cases. First, source routing may be
used by protocols that compute routes centrally on more capable nodes.
Such protocols might first collect link state information from the
network, and then compute the routes to destination nodes of pending
packets. Second, during experiments, applications can use source routing
to fix the route that data packets traverse in the network.</p>
<p>When the user of SRP provides the source route, or the list of nodes on
the path, SRP stores this information in the data packet header. SRP
looks up the next hop in the source route in the data packet header and
forwards the data packet to the next hop. Once the data packet reaches
the destination, it is considered as being successfully delivered.</p>
<p>SRP is a best-effort protocol. During packet forwarding, if the
underlying MAC layer indicates a failure in delivering packets to the
next hop (i.e., the MAC layer fails to receive the packet
acknowledgement), SRP drops the packet and does not need to notify the
origin node.</p>
</div>
<div class="section" id="packet-format">
<h1>3. Packet Format</h1>
<p>SRP does not have control packets. All the information necessary for
routing is contained in the data packet header.</p>
<p>The SRP data frame consists of the header, the source routing entries
(SR Entry), and the payload as shown below:</p>
<pre class="literal-block">
-------------------------------------------------------------
|   SRP    | SR Entry | SR Entry | ... | SR Entry | Payload |
|  Header  |     0    |     1    |     |    n-1   |         |
-------------------------------------------------------------
</pre>
<p>SR Entry 0 corresponds to the origin node, and SR Entry 1 corresponds to
the first-hop node on the path. Similarly, SR Entry n-1 corresponds to the
destination of the packet. The number of source route entries is equal
to the number of nodes on the path.</p>
<p>SR Entries SHOULD NOT repeat as this can cause unwanted loops.</p>
<div class="section" id="srp-header">
<h2>3.1 SRP header</h2>
<pre class="literal-block">
                     1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     sr_len    |   hops_left   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     seqno     |   payload_id  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p>Field definitions are as follows:</p>
<blockquote>
<ul class="simple">
<li>sr_len: (n) The length of the path in hops. This is equal to the number
of source route entries following the SRC header.</li>
<li>hops_left: The remaining distance (in hops) towards the
destination. Each node MUST decrement this field when it forwards the
packet. It is 0 at the destination. Must be less than sr_len (0..n-1).</li>
<li>seqno: The value of the sequence number counter maintained by the
origin node. The origin node sets this field, and a node
forwarding a data frame MUST NOT modify it. The origin node
SHOULD use increasing sequence numbers with wraparound.</li>
<li>payload_id: Higher-level protocol identifier. The origin sets this
field, and a node forwarding a data frame MUST NOT modify it.</li>
</ul>
</blockquote>
</div>
<div class="section" id="source-routing-entry">
<h2>3.2 Source Routing Entry</h2>
<p>The following diagram shows the format of the Source Routing Entry:</p>
<pre class="literal-block">
                     1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            node_id            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p>Field definition:</p>
<blockquote>
<ul class="simple">
<li>node_id: the link layer address of a node on the path to the
destination.</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="implementation">
<h1>4. Implementation</h1>
<p>An implementation of SRP can be found in the <tt class="docutils literal">tos/lib/net/srp</tt> directory
of TinyOS 2.x source tree.</p>
</div>
<div class="section" id="authors">
<h1>5. Authors</h1>
<div class="line-block">
<div class="line">Chieh-Jan Mike Liang</div>
<div class="line">213 NEB, 3400 N Charles St</div>
<div class="line">Johns Hopkins University</div>
<div class="line">Baltimore, MD 21211</div>
<div class="line"><br /></div>
<div class="line">email - <a class="reference external" href="mailto:cliang4&#64;cs.jhu.edu">cliang4&#64;cs.jhu.edu</a></div>
<div class="line"><br /></div>
<div class="line">Eric B. Decker</div>
<div class="line">Autonomous Systems Lab</div>
<div class="line">University of California, Santa Cruz</div>
<div class="line"><br /></div>
<div class="line">email - <a class="reference external" href="mailto:cire831&#64;gmail.com">cire831&#64;gmail.com</a></div>
<div class="line"><br /></div>
<div class="line">Doug Carlson</div>
<div class="line">213 NEB, 3400 N Charles St</div>
<div class="line">Johns Hopkins University</div>
<div class="line">Baltimore, MD 21211</div>
<div class="line"><br /></div>
<div class="line">email - <a class="reference external" href="mailto:carlson&#64;cs.jhu.edu">carlson&#64;cs.jhu.edu</a></div>
<div class="line"><br /></div>
<div class="line">Omprakash Gnawali</div>
<div class="line">S255 Clark Center, 318 Campus Drive</div>
<div class="line">Stanford University</div>
<div class="line">Stanford, CA  94305</div>
<div class="line"><br /></div>
<div class="line">phone - +1 650 725 6086</div>
<div class="line">email - <a class="reference external" href="mailto:gnawali&#64;cs.stanford.edu">gnawali&#64;cs.stanford.edu</a></div>
</div>
</div>
<div class="section" id="citations">
<h1>6. Citations</h1>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>TEP 138: Source Routing</td></tr>
</tbody>
</table>
</div>
</div>
</body>
</html>
