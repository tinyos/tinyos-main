<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title>Source Routing</title>
<meta name="author" content="Chieh-Jan (Mike) Liang, Doug Carlson, Maria A. Kazandjieva, and Omprakash Gnawali" />
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:date: $Date: 2009-02-03 23:07:32 $
:version: $Revision: 1.12 $
:copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.
*/
body {
  font-family: Times;
  font-size: 16px;
}

.first {
  margin-top: 0 ! important }

.last {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dd {
  margin-bottom: 0.5em }

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.attention, div.caution, div.danger, div.error, div.hint,
div.important, div.note, div.tip, div.warning, div.admonition {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

div.hint p.admonition-title, div.important p.admonition-title,
div.note p.admonition-title, div.tip p.admonition-title,
div.admonition p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em }

div.footer, div.header {
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 0em 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1 {
  font-family: Arial, sans-serif;
  font-size: 20px;
}

h1.title {
 text-align: center;
 font-size: 32px;
}

h2 {
 font-size: 16px;
 font-family: Arial, sans-serif;
}

h2.subtitle {
  text-align: center }

h3 {
 font-size: 12px;
 font-family: Arial, sans-serif;
}

hr {
  width: 75% }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.line-block {
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee;
  border-color: #000000;
  border-width: thin;
  font-size: 14px
}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.option-argument {
  font-style: italic }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

table {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.citation {
  border-left: solid thin gray ;
  padding-left: 0.5ex }

table.docinfo {
  margin: 2em 4em;
}

table.footnote {
  border-left: solid thin black ;
  padding-left: 0.5ex }

td, th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

th.docinfo-name, th.field-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap;
  }

h1 tt, h2 tt, h3 tt, h4 tt, h5 tt, h6 tt {
  font-size: 100% }

tt {}

ul.auto-toc {
  list-style-type: none }


</style>
</head>
<body>
<div class="document" id="source-routing">
<h1 class="title">Source Routing</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">TEP:</th><td class="field-body">138</td>
</tr>
<tr class="field"><th class="docinfo-name">Group:</th><td class="field-body">Net2 Working Group</td>
</tr>
<tr class="field"><th class="docinfo-name">Type:</th><td class="field-body">Documentary</td>
</tr>
<tr><th class="docinfo-name">Status:</th>
<td>Draft</td></tr>
<tr class="field"><th class="docinfo-name">TinyOS-Version:</th><td class="field-body">&gt; 2.1</td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>Chieh-Jan (Mike) Liang, Doug Carlson, Maria A. Kazandjieva, and Omprakash Gnawali</td></tr>
<tr class="field"><th class="docinfo-name">Draft-Created:</th><td class="field-body">28-May-2010</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Version:</th><td class="field-body">1.2</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Modified:</th><td class="field-body">2010-06-09</td>
</tr>
<tr class="field"><th class="docinfo-name">Draft-Discuss:</th><td class="field-body">TinyOS Developer List &lt;tinyos-devel at mail.millennium.berkeley.edu&gt;</td>
</tr>
</tbody>
</table>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">This memo documents a part of TinyOS for the TinyOS Community, and
requests discussion and suggestions for improvements.  Distribution
of this memo is unlimited. This memo is in full compliance with
TEP 1.</p>
</div>
<div class="section" id="abstract">
<h1>Abstract</h1>
<p>This memo documents the interfaces and components used for source
routing in TinyOS 2.x. Source routing allows its users to specify the
path a packet must take to reach the destination.</p>
</div>
<div class="section" id="introduction">
<h1>1. Introduction</h1>
<p>Source routes are paths explicitly provided by its users. These
routes, often in the form of a list of nodes to be traversed on the
way to the destination, are carried in the packet header. When a node
receives a source-routed packet, it looks up the next hop in the
source routing packet header and forwards the packet to that node.</p>
<p>A complete source routing system is comprised of two sets of
functionality: the first deals with reading and writing source routes
and the second handles forwarding based on source routes.</p>
<p>A source routing system can be used in many ways. This can be useful
as a light-weight routing system for debugging or for environments
that are static enough that the routes are known ahead of time. It can
also be used by routing systems that compute the path at a given node
based on topology information from the network. For example, given the
link state information of a network, a node can source route a packet
to any node in the network. Source routing is also useful to route a
packet along the reverse path to the original sender.</p>
<p>Our approach provides the most basic source routing system as an
example of a light-weight end-to-end protocol that can also be used in
conjunction with other routing and forwarding systems. Our focus in
this document is to specify a best-effort source routing system.</p>
<p>The rest of this document describes the source routing interfaces and
components.</p>
</div>
<div class="section" id="source-routing-interfaces">
<h1>2. Source Routing Interfaces</h1>
<p>A node can perform three different roles in source routing:</p>
<blockquote>
<ul class="simple">
<li>Sender: Configuring the source route and send a packet</li>
<li>Forwarder: Receive a source routed packet and forward it to the next hop</li>
<li>Receiver: Receive a source routed packet at the destination</li>
</ul>
</blockquote>
<p>Multiple sender applications can use the source routing system. These senders
are uniquely identified by sourceroute identifiers. These identifiers work
like collection identifiers in collection protocols[<a class="reference internal" href="#id1">1</a>].</p>
<p>The sender uses the SourceRouteSend interface to set the contents of a packet.
The sender uses the SourceRouteSend interface to introduce a packet into the network.</p>
<pre class="literal-block">
interface SourceRouteSend {
  command error_t send(am_addr_t *path, uint8_t pathLen, message_t* msg, uint8_t len);
  command error_t cancel(message_t* msg);
  event void sendDone(message_t* msg, error_t error);
  command uint8_t maxPayloadLength();
  command void* getPayload(message_t* msg, uint8_t len);
}
</pre>
<p>The forwarder uses the SourceRoutePacket interface to update the header as it
forwards the packet:</p>
<pre class="literal-block">
interface SourceRoutePacket
{
  command am_addr_t address();

  command error_t clearRoute(message_t *msg);

  command error_t setRoute(message_t *msg, nx_am_addr_t *path, uint8_t len);
  command nx_am_addr_t* getRoute(message_t *msg);

  command uint8_t getRouteLen(message_t *msg);
  command error_t setRouteLen(message_t *msg, uint8_t len);

  command am_addr_t getNextHop(message_t *msg);
  command am_addr_t getDest(message_t *msg);

  command uint8_t getCurHop(message_t *msg);
  command error_t setCurHop(message_t *msg, uint8_t hop);

}
</pre>
</div>
<div class="section" id="source-routing-services">
<h1>3. Source Routing Services</h1>
<p>A source routing service MUST provide one SourceRoutingC,
which has the following signature:</p>
<pre class="literal-block">
configuration SourceRoutingC {
  provides {
    interface StdControl;
    interface SourceRouteSend[uint8_t client];
    interface SourceRoutePacket;
    interface Receive[sourceroute_id_t id];
  }
  uses {
    interface SourceRouteId[uint8_t client];
  }
}
</pre>
</div>
<div class="section" id="implementation">
<h1>4. Implementation</h1>
<p>An implementation of source routing service will be found in
<tt class="docutils literal"><span class="pre">tinyos-2.x/tos/lib/net/sourceroute</span></tt>.</p>
</div>
<div class="section" id="author-addresses">
<h1>5. Author Addresses</h1>
<div class="line-block">
<div class="line">Chieh-Jan (Mike) Liang</div>
<div class="line">213 NEB, 3400 N Charles St</div>
<div class="line">Johns Hopkins University</div>
<div class="line">Baltimore, MD 21211</div>
<div class="line"><br /></div>
<div class="line">email - <a class="reference external" href="mailto:cliang4&#64;cs.jhu.edu">cliang4&#64;cs.jhu.edu</a></div>
<div class="line"><br /></div>
<div class="line">Doug Carlson</div>
<div class="line">213 NEB, 3400 N Charles St</div>
<div class="line">Johns Hopkins University</div>
<div class="line">Baltimore, MD 21211</div>
<div class="line"><br /></div>
<div class="line">email -  <a class="reference external" href="mailto:carlson&#64;cs.jhu.edu">carlson&#64;cs.jhu.edu</a></div>
<div class="line"><br /></div>
<div class="line">Maria A. Kazandjieva</div>
<div class="line">284 Gates Computer Science, 353 Serra Mall</div>
<div class="line">Stanford University</div>
<div class="line">Stanford, CA 94305</div>
<div class="line"><br /></div>
<div class="line">email - <a class="reference external" href="mailto:mariakaz&#64;cs.stanford.edu">mariakaz&#64;cs.stanford.edu</a></div>
<div class="line"><br /></div>
<div class="line">Omprakash Gnawali</div>
<div class="line">S255 Clark Center, 318 Campus Drive</div>
<div class="line">Stanford University</div>
<div class="line">Stanford, CA  94305</div>
<div class="line"><br /></div>
<div class="line">phone - +1 650 725 6086</div>
<div class="line">email - <a class="reference external" href="mailto:gnawali&#64;cs.stanford.edu">gnawali&#64;cs.stanford.edu</a></div>
</div>
</div>
<div class="section" id="citations">
<h1>6. Citations</h1>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>TEP 119: Collection</td></tr>
</tbody>
</table>
</div>
</div>
</body>
</html>
